---
layout: '[default_layout]'   
title: SQL学习笔记3(SQL函数)                
date: 2018-04-02 22:47:41  
updated: 
permalink: 
render_drafts: true
copyright: true
password: 
comments: true
toc: true                  
tags:                        
- SQL

categories:                  
- SQL

---
# SQL 函数
SQL 拥有很多可用于计数和计算的内建函数。

## SQL Aggregate 函数
SQL Aggregate 函数计算从列中取得的值，返回一个单一的值。

有用的 Aggregate 函数：
<!--more-->
- AVG() - 返回平均值
- COUNT() - 返回行数
- FIRST() - 返回第一个记录的值
- LAST() - 返回最后一个记录的值
- MAX() - 返回最大值
- MIN() - 返回最小值
- SUM() - 返回总和
- SQL Scalar 函数
- SQL Scalar 函数基于输入值，返回一个单一的值。

有用的 Scalar 函数：

- UCASE() - 将某个字段转换为大写
- LCASE() - 将某个字段转换为小写
- MID() - 从某个文本字段提取字符，MySql 中使用
- SubString(字段，1，end) - 从某个文本字段提取字符
- LENGTH() - 返回某个文本字段的长度
- ROUND() - 对某个数值字段进行指定小数位数的四舍五入
- NOW() - 返回当前的系统日期和时间
- FORMAT() - 格式化某个字段的显示方式

# 1、SQL COUNT() 函数
COUNT() 函数返回匹配指定条件的行数。

## COUNT(column_name) 函数返回指定列的值的数目（NULL 不计入）：

SELECT COUNT(column_name) FROM table_name;

## COUNT(*) 函数返回表中的记录数：
SELECT COUNT(*) FROM table_name;

## COUNT(DISTINCT column_name) 函数返回指定列的不同值的数目：
SELECT COUNT(DISTINCT column_name) FROM table_name;
```
SELECT AVG(column_name) FROM table_name
SELECT site_id, count FROM access_log WHERE count > (SELECT AVG(count) FROM access_log);

-- 查询所有记录的条数
select count(*) from access_log;

-- 查询websites 表中 alexa列中不为空的记录的条数
select count(alexa) from websites;

-- 查询websites表中 country列中不重复的记录条数
select count(distinct country) from websites;
```
# 2、SQL FIRST() 函数
SELECT FIRST(column_name) FROM table_name; 
注释：只有 MS Access 支持 FIRST() ,LAST()函数。

MySQL 语法
SELECT column_name FROM table_name  ( ORDER BY column_name ASC )  LIMIT 1;

SELECT column_name FROM table_name  ORDER BY column_name DESC  LIMIT 1;

SELECT MAX(column_name) FROM table_name;

SELECT MIN(column_name) FROM table_name;

SELECT SUM(column_name) FROM table_name;  表中值的和

# 3、SQL GROUP BY 语句
GROUP BY 语句用于结合聚合函数，根据一个或多个列对结果集进行分组。

SQL GROUP BY 语法
SELECT column_name, aggregate_function(column_name)
FROM table_name
WHERE column_name operator value
GROUP BY column_name;

SQL GROUP BY 多表连接
现在我们想要查找每个送货员配送的订单数目。

SELECT Websites.name,COUNT(access_log.aid) AS nums FROM access_log
LEFT JOIN Websites
ON access_log.site_id=Websites.id
GROUP BY Websites.name;

# 4、SQL HAVING 子句
在 SQL 中增加 HAVING 子句原因是，WHERE 关键字无法与聚合函数一起使用。

HAVING 子句可以让我们筛选分组后的各组数据。

SQL HAVING 语法
SELECT column_name, aggregate_function(column_name)
FROM table_name
WHERE column_name operator value
GROUP BY column_name
HAVING aggregate_function(column_name) operator value;

现在我们想要查找总访问量大于 200 的网站，并且 alexa 排名小于 200。

SELECT Websites.name, SUM(access_log.count) AS nums FROM Websites
INNER JOIN access_log
ON Websites.id=access_log.site_id
WHERE Websites.alexa < 200 
GROUP BY Websites.name
HAVING SUM(access_log.count) > 200;

# 5、SQL MID() 函数
MID() 函数用于从文本字段中提取字符。

SQL MID() 语法
SELECT MID(column_name,start[,length]) FROM table_name;

参数  描述
column_name 必需。要提取字符的字段。
start   必需。规定开始位置（起始值是 1）。
length  可选。要返回的字符数。如果省略，则 MID() 函数返回剩余文本。

## mid和substring方法有何区别
substring用的范围更加大一些,对参数的要求低一些,能对参数自动使用ROUND()比如
可以这样substring("12345", 1.5, 2.6) 
但是却不能MID("12345", 1.5, 2.6)

注意：两者的参数中的获取字符的起始位置不同，Mid 是从 1 开始，subString 是从 0 开始。
例如，提取字符串中的第一个字符：
```
Dim str As String = "1234"
Dim s1 As String = Mid(str, 1, 1)
Dim s2 As String = str.SubString(0, 1)
```

SELECT LENGTH(column_name) FROM table_name;

# 5、SQL ROUND() 函数
ROUND() 函数用于把数值字段舍入为指定的小数位数。
SELECT ROUND(column_name,decimals) FROM table_name;

参数  描述
column_name 必需。要舍入的字段。
decimals    必需。规定要返回的小数位数。

SQL ROUND() 实例
ROUND(X)： 返回参数X的四舍五入的一个整数。

mysql> select ROUND(-1.23);
        -> -1
mysql> select ROUND(-1.58);
        -> -2
mysql> select ROUND(1.58);
        -> 2
ROUND(X,D)： 返回参数X的四舍五入的有 D 位小数的一个数字。如果D为0，结果将没有小数点或小数部分。

mysql> select ROUND(1.298, 1);
        -> 1.3
mysql> select ROUND(1.298, 0);
        -> 1
注意：ROUND 返回值被变换为一个BIGINT!

# 6、SELECT NOW() AS  colun_name  FROM table_name;

SELECT FORMAT(column_name,format) FROM table_name;

SELECT name, url, DATE_FORMAT(Now(),'%Y-%m-%d') AS date  FROM Websites;

# 6、[SQL 快速参考](http://www.runoob.com/sql/sql-quickref.html)
这里包含了基本所有的sql语句使用示例。


